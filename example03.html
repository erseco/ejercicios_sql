<!DOCTYPE html>
<html>
<head>
    <title>Example 3</title>

    <!-- We add here the alasql library: http://alasql.org/ -->
    <script type="text/javascript" src="js/alasql.js"></script>

    <script type="text/javascript">

    alasql(`
        CREATE TABLE people (
            Id INT AUTOINCREMENT PRIMARY KEY,
            FirstName STRING,
            LastName STRING
        );
    `);

    alasql(`

        INSERT INTO people VALUES
            (1,"Peter","Peterson"),
            (2,"Eric","Ericson"),
            (3,"John","Johnson");
    `);

    function print_table() {

        alasql("SELECT * INTO HTML('#log',{headers:true}) FROM people;")

    }

    function insert_data() {

        firstname = document.getElementById("firstname").value;
        lastname = document.getElementById("lastname").value;

        result = alasql("INSERT INTO people (FirstName, LastName) VALUES ('" + firstname + "', '" + lastname + "');");

        console.log(result);

        print_table();

    }

</script>


</head>
<body>
    <a href="index.html">Go back</a>
    <br />
    <br />

    <form>
        <div>
            <span>
                <label>First</label>
                <input id="firstname" name= "firstname" maxlength="255" size="8" value=""/>
            </span>
            <span>
                <label>Last</label>
                <input id="lastname" name= "lastname" maxlength="255" size="14" value=""/>
            </span>
        </div>
        <br />
        <input type="button" name="submit" value="Submit" onclick="insert_data();" />
        <input type="reset" name="reset" value="Reset" />

    </form>

    <br />

    <div id="log"></div>

    <h2>Questions:</h2>
    <ol>
        <li>What means <strong>AUTOINCREMENT</strong> in the <strong>Id</strong> field?</li><br />
        <li>What is the purpose of the <strong>print_table()</strong> function? When it is called?</li><br />
        <li>What happens if we submit the form with empty fields?</li><br />
        <li>Enter a new user with the name <strong>Juan</strong> and the lastname <strong><pre>Palomo'); INSERT INTO people VALUES (0, 'hacked', 'hacked</pre></strong> what happens?</li><br />
        <li>Enter a new user with the name <strong>Luis</strong> and the lastname <strong><pre>Candelas'); UPDATE people SET FirstName = 'hacked', LastName = 'hacked'; SELECT ('1</pre></strong> what happens?</li><br />
        <li>Enter a new user with the name <strong>King</strong> and the lastname <strong><pre>Africa'); DROP TABLE people; SELECT ('1</pre></strong> what happens?</li>
        <li>As you see, this form is vulnerable, do you know why?</li><br />
        <li>How can we solve it? Give some ideas</li><br />
    </ol>

</body>
<script type="text/javascript">
    // Why we call here the function?
    print_table();
</script>
</html>